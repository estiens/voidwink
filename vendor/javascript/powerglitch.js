// powerglitch@2.4.0 downloaded from https://ga.jspm.io/npm:powerglitch@2.4.0/lib/index.esm.js

var t=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,p=(n,i,r)=>i in n?t(n,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[i]=r,g=(t,n)=>{for(var i in n||(n={}))a.call(n,i)&&p(t,i,n[i]);if(r)for(var i of r(n))o.call(n,i)&&p(t,i,n[i]);return t},G=(t,r)=>n(t,i(r));const y=(t="always")=>({playMode:t,optimizeSeo:!0,createContainers:!0,hideOverflow:!1,timing:t==="always"?{duration:2e3,iterations:1/0}:{duration:250,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0},pulse:!1}),v=(t,n)=>{if(!t.glitchTimeSpan)return 1;const i=t.glitchTimeSpan.start,r=t.glitchTimeSpan.end;if(n<i||n>r)return 0;const a=i+(r-i)/2;return n<a?(n-i)/(a-i):(r-n)/(r-a)},u=(t,n)=>2*(Math.random()-.5)*v(t,n),b=({minHeight:t,maxHeight:n,minWidth:i,maxWidth:r})=>{const a=Math.floor(Math.random()*(100*(n-t)+1))+t*100,o=Math.floor(Math.random()*(100*(r-i)+1))+i*100,s=Math.floor(Math.random()*(100-a)),c=Math.floor(Math.random()*(100-o)),d=`${c+o}% ${s}%`,f=`${c+o}% ${s+a}%`,$=`${c}% ${s+a}%`,E=`${c}% ${s}%`;return`polygon(${d},${f},${$},${E})`},M=t=>{const n=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,i=[];for(let r=0;r<n;++r){if(v(t,r/n)===0){i.push({opacity:"0",transform:"none",clipPath:"unset"});continue}const a={opacity:"1",transform:`translate3d(${u(t,r/n)*30}%,0,0)`,clipPath:b({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1})};t.slice.hueRotate&&(a.filter=`hue-rotate(${Math.floor(u(t,r/n)*360)}deg)`),i.push(a)}return{steps:i,timing:g({easing:`steps(${n},jump-start)`},t.timing)}},A=t=>t.pulse?{steps:[{transform:"scale(1)",opacity:"1"},{transform:`scale(${t.pulse.scale})`,opacity:"0"}],timing:G(g({},t.timing),{delay:(t.glitchTimeSpan?t.glitchTimeSpan.start:0)*t.timing.duration,easing:"ease-in-out"})}:null,x=t=>{if(!t.shake)return{steps:[],timing:{}};const n=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,i=[];for(let r=0;r<n;++r){const a=u(t,r/n)*t.shake.amplitudeX*100,o=u(t,r/n)*t.shake.amplitudeY*100;i.push({transform:`translate3d(${a}%,${o}%,0)`})}return{steps:i,timing:g({easing:`steps(${n},jump-start)`},t.timing)}},w=t=>[x(t),A(t),...Array.from({length:t.slice.count}).map((()=>M(t)))].filter((t=>t!==null)),m=(...t)=>{const e=t=>t&&typeof t=="object";return t.reduce(((t,n)=>(Object.keys(n).forEach((i=>{e(t[i])&&e(n[i])?t[i]=m(t[i],n[i]):n[i]!==void 0&&(t[i]=n[i])})),t)),{})},L=(t,n)=>{var i,r;if(!n.createContainers)return{container:t,layersContainer:t,glitched:t.firstElementChild};if(!t.dataset.glitched){const n=document.createElement("div"),r=document.createElement("div");return getComputedStyle(t).getPropertyValue("display").match(/^inline/)&&(r.style.display="inline-block"),r.appendChild(n),(i=t.parentElement)==null||i.insertBefore(r,t),n.prepend(t),{container:r,layersContainer:n,glitched:t}}const a=t.parentElement,o=(r=t.parentElement)==null?void 0:r.parentElement;for(;a.children.length>1;)a.removeChild(a.children[1]);return a.firstElementChild.getAnimations().forEach((t=>t.cancel())),{container:o,layersContainer:a,glitched:t}},O=(t,n,i)=>{const{glitched:r,container:a,layersContainer:o}=L(t,i);o.style.display="grid",i.hideOverflow&&(a.style.overflow="hidden"),i.html&&(r.innerHTML=i.html),r.style.gridArea="1/1/-1/-1";const s=r.cloneNode(!0);s.dataset.islayer="true",s.style.gridArea="1/1/-1/-1",s.style.userSelect="none",s.style.pointerEvents="none",s.style.opacity="0";for(let t=0;t<n.length-1;++t){const t=s.cloneNode(!0);o.appendChild(t)}const l=()=>{n.forEach(((t,n)=>{o.children[n].animate(t.steps,t.timing)}))},h=()=>{n.forEach(((t,n)=>{o.children[n].getAnimations().forEach((t=>{t.cancel()}))}))};switch(a.onmouseenter=null,a.onmouseleave=null,a.onclick=null,i.playMode){case"always":l();break;case"hover":a.onmouseenter=l,a.onmouseleave=h;break;case"click":a.onclick=()=>{h(),l()};break}return t.dataset.glitched="1",{container:a,startGlitch:l,stopGlitch:h}},H=(t=".powerglitch",n={})=>{const i=m(y(n.playMode),n);if(i.optimizeSeo&&/google|bing|baidu|yandex|slurp|bot/i.exec(navigator.userAgent))return{containers:[],startGlitch:()=>{console.warn("PowerGlitch disabled")},stopGlitch:()=>{console.warn("PowerGlitch disabled")}};let r=[];typeof t=="string"?r=Array.from(document.querySelectorAll(t)):t instanceof NodeList?r=Array.from(t):Array.isArray(t)?r=t:t instanceof HTMLElement&&(r=[t]);const a=w(i),o=r.filter((t=>!t.dataset.islayer)).map((t=>O(t,a,i)));return{containers:o.map((t=>t.container)),startGlitch:()=>o.forEach((t=>t.startGlitch())),stopGlitch:()=>o.forEach((t=>t.stopGlitch()))}},s={glitch:H,generateLayers:w,getDefaultOptions:y};export{s as PowerGlitch,m as mergeOptions};

